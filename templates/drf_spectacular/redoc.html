{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <title>{{ title|default:"The Dozens API Documentation - ReDoc" }}</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Comprehensive API documentation for The Dozens - Yo Mama Jokes API">

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="{% static 'assets/favicon.ico' %}">

    <!-- Preconnect to external resources -->
    <link rel="preconnect" href="https://cdn.jsdelivr.net">

    <!-- Preload critical fonts -->
    <link rel="preload" href="https://cdn.jsdelivr.net/gh/Terry-BrooksJr/the-dozens-django@c39984f366fe21d0e62d3c38bac514535e5b89a7/static/fonts/caloriesuit.woff2" as="font" type="font/woff2" crossorigin>
    <link rel="preload" href="https://cdn.jsdelivr.net/gh/Terry-BrooksJr/the-dozens-django@cfed15844ea94edfc7e4f61a1fb60f92570aeb68/static/fonts/JuliusSansOne-Regular.woff2" as="font" type="font/woff2" crossorigin>

    <!-- Custom styling to match The Dozens theme -->
    <style>
      /* Font definitions */
      @font-face {
        font-family: YoMamaHeader;
        src: url('https://cdn.jsdelivr.net/gh/Terry-BrooksJr/the-dozens-django@c39984f366fe21d0e62d3c38bac514535e5b89a7/static/fonts/caloriesuit.woff2') format('woff2');
        font-display: swap;
      }

      @font-face {
        font-family: YoMamaBody;
        src: url('https://cdn.jsdelivr.net/gh/Terry-BrooksJr/the-dozens-django@cfed15844ea94edfc7e4f61a1fb60f92570aeb68/static/fonts/JuliusSansOne-Regular.woff2') format('woff2');
        font-display: swap;
      }

      /* Color scheme matching The Dozens */
      :root {
        --color-primary: #770071;
        --color-secondary: #bd00b4;
        --color-accent: #beda00;
        --color-white: #ffffff;
        --color-background: #D7DF0D;
      }

      /* Base styling */
      html {
        background: linear-gradient(169deg, rgba(215, 223, 13, 1) 0%, rgba(190, 218, 0, 1) 50%, rgba(119, 0, 113, 1) 100%);
        min-height: 100vh;
      }

      body {
        margin: 0;
        padding: 0;
        font-family: "YoMamaBody", -apple-system, BlinkMacSystemFont, "Segoe UI", Arial, sans-serif;
        line-height: 1.6;
      }

      /* Custom header for The Dozens branding */
      .dozens-header {
        background: var(--color-primary);
        color: var(--color-white);
        padding: 1.5rem;
        text-align: center;
        border-bottom: 4px solid var(--color-accent);
        box-shadow: 0 2px 10px rgba(119, 0, 113, 0.3);
        position: relative;
        z-index: 1000;
      }

      .dozens-header h1 {
        font-family: 'YoMamaHeader', Arial, sans-serif;
        font-size: clamp(1.5rem, 4vw, 2.5rem);
        margin: 0.5rem 0;
        text-shadow: -1px -1px 0 var(--color-secondary),
                     1px -1px 0 var(--color-secondary),
                     -1px 1px 0 var(--color-secondary),
                     1px 1px 0 var(--color-secondary);
      }

      .dozens-header p {
        font-family: 'YoMamaBody', Arial, sans-serif;
        margin: 0.5rem 0 1rem 0;
        opacity: 0.9;
        font-size: clamp(0.9rem, 2.5vw, 1.1rem);
      }

      .dozens-header .nav-links {
        display: flex;
        justify-content: center;
        gap: 1rem;
        flex-wrap: wrap;
      }

      .dozens-header .nav-link {
        display: inline-block;
        background: var(--color-accent);
        color: var(--color-primary);
        padding: 0.6rem 1.2rem;
        border-radius: 0.5rem;
        text-decoration: none;
        font-family: 'YoMamaHeader', Arial, sans-serif;
        font-weight: bold;
        transition: all 0.3s ease;
        font-size: clamp(0.8rem, 2vw, 1rem);
      }

      .dozens-header .nav-link:hover {
        background: var(--color-white);
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      }

      .dozens-header .nav-link.primary {
        background: var(--color-secondary);
        color: var(--color-white);
      }

      .dozens-header .nav-link.primary:hover {
        background: var(--color-white);
        color: var(--color-primary);
      }

      /* ReDoc container styling */
      #redoc-container {
        margin: 2rem auto;
        max-width: 1200px;
        background: var(--color-white);
        border-radius: 8px;
        box-shadow: 0 4px 20px rgba(119, 0, 113, 0.3);
        overflow: hidden;
      }

      /* Custom scrollbar */
      ::-webkit-scrollbar {
        width: 8px;
      }

      ::-webkit-scrollbar-track {
        background: #f1f1f1;
      }

      ::-webkit-scrollbar-thumb {
        background: var(--color-primary);
        border-radius: 4px;
      }

      ::-webkit-scrollbar-thumb:hover {
        background: var(--color-secondary);
      }

      /* Mobile responsiveness */
      @media (max-width: 768px) {
        .dozens-header {
          padding: 1rem;
        }

        .dozens-header .nav-links {
          gap: 0.5rem;
        }

        .dozens-header .nav-link {
          padding: 0.5rem 0.8rem;
          font-size: 0.8rem;
        }

        #redoc-container {
          margin: 1rem;
          border-radius: 4px;
        }
      }

      /* Loading animation */
      @keyframes loading {
        0% { opacity: 0.5; }
        50% { opacity: 1; }
        100% { opacity: 0.5; }
      }

      #redoc-container.loading {
        animation: loading 1.5s ease-in-out infinite;
      }

      .loading-message {
        text-align: center;
        padding: 2rem;
        font-family: 'YoMamaBody', Arial, sans-serif;
        color: var(--color-primary);
        font-size: 1.2rem;
      }

      /* Footer styling */
      .dozens-footer {
        background: var(--color-primary);
        color: var(--color-white);
        text-align: center;
        padding: 1rem;
        margin-top: 2rem;
        font-family: 'YoMamaBody', Arial, sans-serif;
        font-size: 0.9rem;
      }

      .dozens-footer a {
        color: var(--color-accent);
        text-decoration: none;
      }

      .dozens-footer a:hover {
        color: var(--color-white);
      }
    </style>
  </head>
  <body>
    <!-- Custom header -->
    <div class="dozens-header">
      <h1>The Dozens API Documentation</h1>
      <p>Comprehensive API documentation for The Yo' Mama Jokes API</p>
      <div class="nav-links">
        <a  href="localhost:3000/" class="nav-link primary">← Main Site</a>
        <a href="{% url 'swagger' %}" class="nav-link">Swagger UI</a>
        <a href="/graphql" class="nav-link">GraphQL</a>
        <a href="{% url 'schema' %}" class="nav-link">OpenAPI Schema</a>
      </div>
    </div>

    <!-- ReDoc container -->
    <div id="redoc-container" class="loading">
      <div class="loading-message">Loading comprehensive API documentation...</div>
    </div>

    <!-- ReDoc JavaScript and initialization -->
    <script src="{{ redoc_standalone }}"></script>
    <script>
    document.addEventListener('DOMContentLoaded', function() {
      const container = document.getElementById('redoc-container');

      {% if settings %}
      // Use custom settings if provided
      const redocSettings = {{ settings|safe }};

      // Enhance settings with custom theme
      const customSettings = {
        ...redocSettings,
        theme: {
          colors: {
            primary: {
              main: '#770071'
            },
            success: {
              main: '#beda00'
            },
            text: {
              primary: '#333333'
            }
          },
          typography: {
            fontFamily: '"YoMamaBody", -apple-system, BlinkMacSystemFont, "Segoe UI", Arial, sans-serif',
            headings: {
              fontFamily: '"YoMamaHeader", Arial, sans-serif'
            }
          },
          sidebar: {
            backgroundColor: '#f8f9fa',
            textColor: '#333333'
          }
        },
        ...redocSettings.theme
      };

      Redoc.init("{{ schema_url }}", customSettings, container)
        .then(() => {
          container.classList.remove('loading');
          // Apply custom styling to ReDoc elements after initialization
          setTimeout(applyCustomStyling, 100);
        })
        .catch((error) => {
          console.error('Error initializing ReDoc:', error);
          container.innerHTML = '<div class="loading-message" style="color: #d32f2f;">Failed to load API documentation. Please try again.</div>';
        });
      {% else %}
      // Fallback initialization
      Redoc.init("{{ schema_url }}", {
        theme: {
          colors: {
            primary: {
              main: '#770071'
            },
            success: {
              main: '#beda00'
            }
          },
          typography: {
            fontFamily: '"YoMamaBody", -apple-system, BlinkMacSystemFont, "Segoe UI", Arial, sans-serif',
            headings: {
              fontFamily: '"YoMamaHeader", Arial, sans-serif'
            }
          }
        }
      }, container)
        .then(() => {
          container.classList.remove('loading');
          setTimeout(applyCustomStyling, 100);
        })
        .catch((error) => {
          console.error('Error initializing ReDoc:', error);
          container.innerHTML = '<div class="loading-message" style="color: #d32f2f;">Failed to load API documentation. Please try again.</div>';
        });
      {% endif %}

      // Function to apply additional custom styling after ReDoc loads
      function applyCustomStyling() {
        // Add custom classes or styles to ReDoc elements
        const headings = container.querySelectorAll('h1, h2, h3, h4, h5, h6');
        headings.forEach(heading => {
          heading.style.fontFamily = '"YoMamaHeader", Arial, sans-serif';
          heading.style.color = '#770071';
        });

        const codeBlocks = container.querySelectorAll('code, pre');
        codeBlocks.forEach(code => {
          code.style.fontFamily = 'Monaco, Consolas, "Liberation Mono", "Courier New", monospace';
        });
      }
    });
    </script>

    <!-- Footer -->
    <div class="dozens-footer">
      <p>&copy; 2024 The Dozens API. Built with ❤️ by <a href="https://www.brooksjr.com" target="_blank">Terry Brooks Jr</a></p>
    </div>
  </body>
</html>